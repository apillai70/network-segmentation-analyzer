{
  "analysis_timestamp": "2025-10-17T13:47:41.672344",
  "summary": {
    "total_flows": 0,
    "total_bytes": 0,
    "total_packets": 0,
    "unique_apps": 0,
    "app_distribution": {},
    "protocol_distribution": {},
    "top_ports": {},
    "internal_flows": 0,
    "external_flows": 0,
    "suspicious_count": 0
  },
  "top_talkers": {
    "top_sources_by_bytes": {},
    "top_sources_by_sessions": {},
    "top_destinations_by_bytes": {},
    "top_destinations_by_sessions": {}
  },
  "port_analysis": {
    "total_unique_ports": 0,
    "port_details": {},
    "rare_ports": {}
  },
  "peer_pairs": [],
  "suspicious_flows": [],
  "temporal_patterns": {
    "hour_distribution": {},
    "day_distribution": {},
    "peak_hour": 0,
    "peak_day": "Unknown"
  },
  "flow_classification": {
    "internal": 0,
    "external_inbound": 0,
    "external_outbound": 0,
    "east_west": 0,
    "north_south": 0
  },
  "zones": {
    "EXTERNAL": {
      "zone_name": "EXTERNAL",
      "zone_type": "macro",
      "members": [],
      "description": "Internet-facing zone",
      "security_level": 1,
      "parent_zone": null
    },
    "DMZ": {
      "zone_name": "DMZ",
      "zone_type": "macro",
      "members": [],
      "description": "Demilitarized zone for public services",
      "security_level": 2,
      "parent_zone": null
    },
    "INTERNAL": {
      "zone_name": "INTERNAL",
      "zone_type": "macro",
      "members": [],
      "description": "Internal network",
      "security_level": 3,
      "parent_zone": null
    }
  },
  "rules": [
    {
      "priority": 150,
      "source": "DATA_TIER",
      "destination": "WEB_TIER",
      "protocol": "any",
      "port": "any",
      "action": "deny",
      "justification": "Prevent reverse traffic from data tier to web tier - data exfiltration protection",
      "risk_score": 85,
      "enforcement_target": "internal-firewall",
      "complexity": "low",
      "zone_src": "DATA_TIER",
      "zone_dst": "WEB_TIER",
      "rule_id": "RULE-1017"
    },
    {
      "priority": 300,
      "source": "any",
      "destination": "WEB_TIER",
      "protocol": "tcp",
      "port": "80",
      "action": "allow",
      "justification": "Allow HTTP traffic to web tier - legitimate public access",
      "risk_score": 20,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "WEB_TIER",
      "rule_id": "RULE-1008"
    },
    {
      "priority": 300,
      "source": "any",
      "destination": "WEB_TIER",
      "protocol": "tcp",
      "port": "443",
      "action": "allow",
      "justification": "Allow HTTPS traffic to web tier - legitimate public access",
      "risk_score": 20,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "WEB_TIER",
      "rule_id": "RULE-1009"
    },
    {
      "priority": 400,
      "source": "WEB_TIER",
      "destination": "APP_TIER",
      "protocol": "tcp",
      "port": "8080,8443",
      "action": "allow",
      "justification": "Allow web tier to communicate with application tier",
      "risk_score": 15,
      "enforcement_target": "internal-firewall",
      "complexity": "medium",
      "zone_src": "WEB_TIER",
      "zone_dst": "APP_TIER",
      "rule_id": "RULE-1010"
    },
    {
      "priority": 600,
      "source": "APP_TIER",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "6379",
      "action": "allow",
      "justification": "Allow app tier to access Redis cache",
      "risk_score": 20,
      "enforcement_target": "internal-firewall",
      "complexity": "low",
      "zone_src": "APP_TIER",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1014"
    },
    {
      "priority": 700,
      "source": "APP_TIER",
      "destination": "MESSAGING_TIER",
      "protocol": "tcp",
      "port": "9092,5672",
      "action": "allow",
      "justification": "Allow app tier to access message queues (Kafka, RabbitMQ)",
      "risk_score": 20,
      "enforcement_target": "internal-firewall",
      "complexity": "medium",
      "zone_src": "APP_TIER",
      "zone_dst": "MESSAGING_TIER",
      "rule_id": "RULE-1015"
    },
    {
      "priority": 800,
      "source": "MANAGEMENT_TIER",
      "destination": "any",
      "protocol": "tcp",
      "port": "9090,9100,4040",
      "action": "allow",
      "justification": "Allow management tier to collect metrics from all tiers",
      "risk_score": 30,
      "enforcement_target": "internal-firewall",
      "complexity": "high",
      "zone_src": "MANAGEMENT_TIER",
      "zone_dst": "INTERNAL",
      "rule_id": "RULE-1016"
    },
    {
      "priority": 1101,
      "source": "EXTERNAL",
      "destination": "any",
      "protocol": "tcp",
      "port": "22",
      "action": "deny",
      "justification": "Block SSH access from external networks - high security risk",
      "risk_score": 90,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "INTERNAL",
      "rule_id": "RULE-1001"
    },
    {
      "priority": 1102,
      "source": "EXTERNAL",
      "destination": "any",
      "protocol": "tcp",
      "port": "3389",
      "action": "deny",
      "justification": "Block RDP access from external networks - high security risk",
      "risk_score": 90,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "INTERNAL",
      "rule_id": "RULE-1002"
    },
    {
      "priority": 1103,
      "source": "EXTERNAL",
      "destination": "any",
      "protocol": "tcp",
      "port": "23",
      "action": "deny",
      "justification": "Block Telnet access from external networks - high security risk",
      "risk_score": 90,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "INTERNAL",
      "rule_id": "RULE-1003"
    },
    {
      "priority": 1204,
      "source": "EXTERNAL",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "3306",
      "action": "deny",
      "justification": "Block direct MySQL access from external - data exfiltration risk",
      "risk_score": 95,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1004"
    },
    {
      "priority": 1205,
      "source": "EXTERNAL",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "5432",
      "action": "deny",
      "justification": "Block direct PostgreSQL access from external - data exfiltration risk",
      "risk_score": 95,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1005"
    },
    {
      "priority": 1206,
      "source": "EXTERNAL",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "27017",
      "action": "deny",
      "justification": "Block direct MongoDB access from external - data exfiltration risk",
      "risk_score": 95,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1006"
    },
    {
      "priority": 1207,
      "source": "EXTERNAL",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "6379",
      "action": "deny",
      "justification": "Block direct Redis access from external - data exfiltration risk",
      "risk_score": 95,
      "enforcement_target": "perimeter-firewall",
      "complexity": "low",
      "zone_src": "EXTERNAL",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1007"
    },
    {
      "priority": 1511,
      "source": "APP_TIER",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "3306",
      "action": "allow",
      "justification": "Allow app tier to access MySQL databases",
      "risk_score": 25,
      "enforcement_target": "internal-firewall",
      "complexity": "medium",
      "zone_src": "APP_TIER",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1011"
    },
    {
      "priority": 1512,
      "source": "APP_TIER",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "5432",
      "action": "allow",
      "justification": "Allow app tier to access PostgreSQL databases",
      "risk_score": 25,
      "enforcement_target": "internal-firewall",
      "complexity": "medium",
      "zone_src": "APP_TIER",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1012"
    },
    {
      "priority": 1513,
      "source": "APP_TIER",
      "destination": "DATA_TIER",
      "protocol": "tcp",
      "port": "27017",
      "action": "allow",
      "justification": "Allow app tier to access MongoDB databases",
      "risk_score": 25,
      "enforcement_target": "internal-firewall",
      "complexity": "medium",
      "zone_src": "APP_TIER",
      "zone_dst": "DATA_TIER",
      "rule_id": "RULE-1013"
    },
    {
      "priority": 9999,
      "source": "any",
      "destination": "any",
      "protocol": "any",
      "port": "any",
      "action": "deny",
      "justification": "Default deny policy for zero-trust architecture",
      "risk_score": 0,
      "enforcement_target": "firewall",
      "complexity": "low",
      "zone_src": "",
      "zone_dst": "",
      "rule_id": "RULE-1000"
    }
  ]
}